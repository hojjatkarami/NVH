function F = myfun(x)

m = 150;	% mass of the engine or powertrain
I = [5.82 -0.82 0.19 ; -0.82 3.41 -0.21 ; 0.19 -0.21 5.50];     % Inertia matrix
M = [m*eye(3) zeros(3) ; zeros(3) I];
kp1=x(1);kp2=x(2);kp3=x(3);kq1=x(4);kq2=x(5);kq3=x(6);kr1=x(7);kr2=x(8);kr3=x(9);o1_1=x(10);o1_2=x(11);o1_3=x(12);o2_1=x(13);o2_2=x(14);o2_3=x(15);o3_1=x(16);o3_2=x(17);o3_3=x(18);r1_1=x(19);r1_2=x(20);r1_3=x(21);r2_1=x(22);r2_2=x(23);r2_3=x(24);r3_1=x(25);r3_2=x(26);r3_3=x(27);w2_TRA=x(28);
K = [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       kq1*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))^2 + kq2*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))^2 + kq3*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))^2 + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))^2 + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))^2 + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))^2 + kp1*cos(o1_2)^2*cos(o1_3)^2 + kp2*cos(o2_2)^2*cos(o2_3)^2 + kp3*cos(o3_2)^2*cos(o3_3)^2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       kp1*cos(o1_2)^2*cos(o1_3)*sin(o1_3) - kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) - kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)) - kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) + kp2*cos(o2_2)^2*cos(o2_3)*sin(o2_3) + kp3*cos(o3_2)^2*cos(o3_3)*sin(o3_3),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       kr1*cos(o1_1)*cos(o1_2)*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2)) - kp2*cos(o2_2)*cos(o2_3)*sin(o2_2) - kp3*cos(o3_2)*cos(o3_3)*sin(o3_2) - kp1*cos(o1_2)*cos(o1_3)*sin(o1_2) + kr2*cos(o2_1)*cos(o2_2)*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2)) + kr3*cos(o3_1)*cos(o3_2)*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2)) - kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) - kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) - kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               r1_3*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kp1*cos(o1_2)^2*cos(o1_3)*sin(o1_3)) + r2_3*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kp2*cos(o2_2)^2*cos(o2_3)*sin(o2_3)) + r3_3*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)) + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kp3*cos(o3_2)^2*cos(o3_3)*sin(o3_3)) - r1_2*(kp1*cos(o1_2)*cos(o1_3)*sin(o1_2) - kr1*cos(o1_1)*cos(o1_2)*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2)) + kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))) - r2_2*(kp2*cos(o2_2)*cos(o2_3)*sin(o2_2) - kr2*cos(o2_1)*cos(o2_2)*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2)) + kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))) - r3_2*(kp3*cos(o3_2)*cos(o3_3)*sin(o3_2) - kr3*cos(o3_1)*cos(o3_2)*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2)) + kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 r1_1*(kp1*cos(o1_2)*cos(o1_3)*sin(o1_2) - kr1*cos(o1_1)*cos(o1_2)*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2)) + kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))) + r2_1*(kp2*cos(o2_2)*cos(o2_3)*sin(o2_2) - kr2*cos(o2_1)*cos(o2_2)*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2)) + kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))) + r3_1*(kp3*cos(o3_2)*cos(o3_3)*sin(o3_2) - kr3*cos(o3_1)*cos(o3_2)*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2)) + kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))) + r1_3*(kq1*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))^2 + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))^2 + kp1*cos(o1_2)^2*cos(o1_3)^2) + r2_3*(kq2*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))^2 + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))^2 + kp2*cos(o2_2)^2*cos(o2_3)^2) + r3_3*(kq3*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))^2 + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))^2 + kp3*cos(o3_2)^2*cos(o3_3)^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               - r1_1*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kp1*cos(o1_2)^2*cos(o1_3)*sin(o1_3)) - r2_1*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kp2*cos(o2_2)^2*cos(o2_3)*sin(o2_3)) - r3_1*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)) + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kp3*cos(o3_2)^2*cos(o3_3)*sin(o3_3)) - r1_2*(kq1*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))^2 + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))^2 + kp1*cos(o1_2)^2*cos(o1_3)^2) - r2_2*(kq2*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))^2 + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))^2 + kp2*cos(o2_2)^2*cos(o2_3)^2) - r3_2*(kq3*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))^2 + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))^2 + kp3*cos(o3_2)^2*cos(o3_3)^2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       kp1*cos(o1_2)^2*cos(o1_3)*sin(o1_3) - kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) - kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)) - kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) + kp2*cos(o2_2)^2*cos(o2_3)*sin(o2_3) + kp3*cos(o3_2)^2*cos(o3_3)*sin(o3_3),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))^2 + kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))^2 + kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))^2 + kr1*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3))^2 + kr2*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3))^2 + kr3*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3))^2 + kp1*cos(o1_2)^2*sin(o1_3)^2 + kp2*cos(o2_2)^2*sin(o2_3)^2 + kp3*cos(o3_2)^2*sin(o3_3)^2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3)) - kp2*cos(o2_2)*sin(o2_2)*sin(o2_3) - kp3*cos(o3_2)*sin(o3_2)*sin(o3_3) - kr1*cos(o1_1)*cos(o1_2)*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kr2*cos(o2_1)*cos(o2_2)*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kr3*cos(o3_1)*cos(o3_2)*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kp1*cos(o1_2)*sin(o1_2)*sin(o1_3) + kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3)) + kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             - r1_2*(kp1*cos(o1_2)*sin(o1_2)*sin(o1_3) + kr1*cos(o1_1)*cos(o1_2)*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))) - r2_2*(kp2*cos(o2_2)*sin(o2_2)*sin(o2_3) + kr2*cos(o2_1)*cos(o2_2)*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))) - r3_2*(kp3*cos(o3_2)*sin(o3_2)*sin(o3_3) + kr3*cos(o3_1)*cos(o3_2)*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))) - r1_3*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))^2 + kr1*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3))^2 + kp1*cos(o1_2)^2*sin(o1_3)^2) - r2_3*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))^2 + kr2*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3))^2 + kp2*cos(o2_2)^2*sin(o2_3)^2) - r3_3*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))^2 + kr3*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3))^2 + kp3*cos(o3_2)^2*sin(o3_3)^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 r1_1*(kp1*cos(o1_2)*sin(o1_2)*sin(o1_3) + kr1*cos(o1_1)*cos(o1_2)*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))) - r2_3*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kp2*cos(o2_2)^2*cos(o2_3)*sin(o2_3)) - r3_3*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)) + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kp3*cos(o3_2)^2*cos(o3_3)*sin(o3_3)) - r1_3*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kp1*cos(o1_2)^2*cos(o1_3)*sin(o1_3)) + r2_1*(kp2*cos(o2_2)*sin(o2_2)*sin(o2_3) + kr2*cos(o2_1)*cos(o2_2)*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))) + r3_1*(kp3*cos(o3_2)*sin(o3_2)*sin(o3_3) + kr3*cos(o3_1)*cos(o3_2)*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 r1_2*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kp1*cos(o1_2)^2*cos(o1_3)*sin(o1_3)) + r2_2*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kp2*cos(o2_2)^2*cos(o2_3)*sin(o2_3)) + r3_2*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)) + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kp3*cos(o3_2)^2*cos(o3_3)*sin(o3_3)) + r1_1*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))^2 + kr1*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3))^2 + kp1*cos(o1_2)^2*sin(o1_3)^2) + r2_1*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))^2 + kr2*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3))^2 + kp2*cos(o2_2)^2*sin(o2_3)^2) + r3_1*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))^2 + kr3*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3))^2 + kp3*cos(o3_2)^2*sin(o3_3)^2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         kr1*cos(o1_1)*cos(o1_2)*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2)) - kp2*cos(o2_2)*cos(o2_3)*sin(o2_2) - kp3*cos(o3_2)*cos(o3_3)*sin(o3_2) - kp1*cos(o1_2)*cos(o1_3)*sin(o1_2) + kr2*cos(o2_1)*cos(o2_2)*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2)) + kr3*cos(o3_1)*cos(o3_2)*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2)) - kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) - kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) - kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3)) - kp2*cos(o2_2)*sin(o2_2)*sin(o2_3) - kp3*cos(o3_2)*sin(o3_2)*sin(o3_3) - kr1*cos(o1_1)*cos(o1_2)*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kr2*cos(o2_1)*cos(o2_2)*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kr3*cos(o3_1)*cos(o3_2)*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kp1*cos(o1_2)*sin(o1_2)*sin(o1_3) + kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3)) + kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         kr1*cos(o1_1)^2*cos(o1_2)^2 + kq1*cos(o1_2)^2*sin(o1_1)^2 + kr2*cos(o2_1)^2*cos(o2_2)^2 + kq2*cos(o2_2)^2*sin(o2_1)^2 + kr3*cos(o3_1)^2*cos(o3_2)^2 + kq3*cos(o3_2)^2*sin(o3_1)^2 + kp1*sin(o1_2)^2 + kp2*sin(o2_2)^2 + kp3*sin(o3_2)^2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   r1_3*(kp1*cos(o1_2)*sin(o1_2)*sin(o1_3) + kr1*cos(o1_1)*cos(o1_2)*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))) + r2_3*(kp2*cos(o2_2)*sin(o2_2)*sin(o2_3) + kr2*cos(o2_1)*cos(o2_2)*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))) + r3_3*(kp3*cos(o3_2)*sin(o3_2)*sin(o3_3) + kr3*cos(o3_1)*cos(o3_2)*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))) + r1_2*(kr1*cos(o1_1)^2*cos(o1_2)^2 + kq1*cos(o1_2)^2*sin(o1_1)^2 + kp1*sin(o1_2)^2) + r2_2*(kr2*cos(o2_1)^2*cos(o2_2)^2 + kq2*cos(o2_2)^2*sin(o2_1)^2 + kp2*sin(o2_2)^2) + r3_2*(kr3*cos(o3_1)^2*cos(o3_2)^2 + kq3*cos(o3_2)^2*sin(o3_1)^2 + kp3*sin(o3_2)^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   - r1_3*(kp1*cos(o1_2)*cos(o1_3)*sin(o1_2) - kr1*cos(o1_1)*cos(o1_2)*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2)) + kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))) - r2_3*(kp2*cos(o2_2)*cos(o2_3)*sin(o2_2) - kr2*cos(o2_1)*cos(o2_2)*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2)) + kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))) - r3_3*(kp3*cos(o3_2)*cos(o3_3)*sin(o3_2) - kr3*cos(o3_1)*cos(o3_2)*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2)) + kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))) - r1_1*(kr1*cos(o1_1)^2*cos(o1_2)^2 + kq1*cos(o1_2)^2*sin(o1_1)^2 + kp1*sin(o1_2)^2) - r2_1*(kr2*cos(o2_1)^2*cos(o2_2)^2 + kq2*cos(o2_2)^2*sin(o2_1)^2 + kp2*sin(o2_2)^2) - r3_1*(kr3*cos(o3_1)^2*cos(o3_2)^2 + kq3*cos(o3_2)^2*sin(o3_1)^2 + kp3*sin(o3_2)^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     r1_2*(kp1*cos(o1_2)*cos(o1_3)*sin(o1_2) - kr1*cos(o1_1)*cos(o1_2)*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2)) + kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))) + r2_2*(kp2*cos(o2_2)*cos(o2_3)*sin(o2_2) - kr2*cos(o2_1)*cos(o2_2)*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2)) + kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))) + r3_2*(kp3*cos(o3_2)*cos(o3_3)*sin(o3_2) - kr3*cos(o3_1)*cos(o3_2)*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2)) + kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))) - r1_1*(kp1*cos(o1_2)*sin(o1_2)*sin(o1_3) + kr1*cos(o1_1)*cos(o1_2)*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))) - r2_1*(kp2*cos(o2_2)*sin(o2_2)*sin(o2_3) + kr2*cos(o2_1)*cos(o2_2)*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))) - r3_1*(kp3*cos(o3_2)*sin(o3_2)*sin(o3_3) + kr3*cos(o3_1)*cos(o3_2)*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3)));
 r1_3*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kp1*cos(o1_2)^2*cos(o1_3)*sin(o1_3)) + r2_3*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kp2*cos(o2_2)^2*cos(o2_3)*sin(o2_3)) + r3_3*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)) + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kp3*cos(o3_2)^2*cos(o3_3)*sin(o3_3)) - r1_2*(kp1*cos(o1_2)*cos(o1_3)*sin(o1_2) - kr1*cos(o1_1)*cos(o1_2)*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2)) + kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))) - r2_2*(kp2*cos(o2_2)*cos(o2_3)*sin(o2_2) - kr2*cos(o2_1)*cos(o2_2)*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2)) + kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))) - r3_2*(kp3*cos(o3_2)*cos(o3_3)*sin(o3_2) - kr3*cos(o3_1)*cos(o3_2)*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2)) + kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))),                                                                                                                                                                                                                                                                                                                                               - r1_2*(kp1*cos(o1_2)*sin(o1_2)*sin(o1_3) + kr1*cos(o1_1)*cos(o1_2)*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))) - r2_2*(kp2*cos(o2_2)*sin(o2_2)*sin(o2_3) + kr2*cos(o2_1)*cos(o2_2)*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))) - r3_2*(kp3*cos(o3_2)*sin(o3_2)*sin(o3_3) + kr3*cos(o3_1)*cos(o3_2)*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))) - r1_3*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))^2 + kr1*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3))^2 + kp1*cos(o1_2)^2*sin(o1_3)^2) - r2_3*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))^2 + kr2*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3))^2 + kp2*cos(o2_2)^2*sin(o2_3)^2) - r3_3*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))^2 + kr3*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3))^2 + kp3*cos(o3_2)^2*sin(o3_3)^2),                                                                                                                                                                                                                                                                                                                                                                   r1_3*(kp1*cos(o1_2)*sin(o1_2)*sin(o1_3) + kr1*cos(o1_1)*cos(o1_2)*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))) + r2_3*(kp2*cos(o2_2)*sin(o2_2)*sin(o2_3) + kr2*cos(o2_1)*cos(o2_2)*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))) + r3_3*(kp3*cos(o3_2)*sin(o3_2)*sin(o3_3) + kr3*cos(o3_1)*cos(o3_2)*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))) + r1_2*(kr1*cos(o1_1)^2*cos(o1_2)^2 + kq1*cos(o1_2)^2*sin(o1_1)^2 + kp1*sin(o1_2)^2) + r2_2*(kr2*cos(o2_1)^2*cos(o2_2)^2 + kq2*cos(o2_2)^2*sin(o2_1)^2 + kp2*sin(o2_2)^2) + r3_2*(kr3*cos(o3_1)^2*cos(o3_2)^2 + kq3*cos(o3_2)^2*sin(o3_1)^2 + kp3*sin(o3_2)^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     r1_3*(r1_2*(kp1*cos(o1_2)*sin(o1_2)*sin(o1_3) + kr1*cos(o1_1)*cos(o1_2)*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))) + r1_3*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))^2 + kr1*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3))^2 + kp1*cos(o1_2)^2*sin(o1_3)^2)) + r2_3*(r2_2*(kp2*cos(o2_2)*sin(o2_2)*sin(o2_3) + kr2*cos(o2_1)*cos(o2_2)*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))) + r2_3*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))^2 + kr2*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3))^2 + kp2*cos(o2_2)^2*sin(o2_3)^2)) + r3_3*(r3_2*(kp3*cos(o3_2)*sin(o3_2)*sin(o3_3) + kr3*cos(o3_1)*cos(o3_2)*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))) + r3_3*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))^2 + kr3*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3))^2 + kp3*cos(o3_2)^2*sin(o3_3)^2)) + r1_2*(r1_3*(kp1*cos(o1_2)*sin(o1_2)*sin(o1_3) + kr1*cos(o1_1)*cos(o1_2)*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))) + r1_2*(kr1*cos(o1_1)^2*cos(o1_2)^2 + kq1*cos(o1_2)^2*sin(o1_1)^2 + kp1*sin(o1_2)^2)) + r2_2*(r2_3*(kp2*cos(o2_2)*sin(o2_2)*sin(o2_3) + kr2*cos(o2_1)*cos(o2_2)*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))) + r2_2*(kr2*cos(o2_1)^2*cos(o2_2)^2 + kq2*cos(o2_2)^2*sin(o2_1)^2 + kp2*sin(o2_2)^2)) + r3_2*(r3_3*(kp3*cos(o3_2)*sin(o3_2)*sin(o3_3) + kr3*cos(o3_1)*cos(o3_2)*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))) + r3_2*(kr3*cos(o3_1)^2*cos(o3_2)^2 + kq3*cos(o3_2)^2*sin(o3_1)^2 + kp3*sin(o3_2)^2)),                                                                                                                                                                                                                                       r1_3*(r1_3*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kp1*cos(o1_2)^2*cos(o1_3)*sin(o1_3)) - r1_2*(kp1*cos(o1_2)*cos(o1_3)*sin(o1_2) - kr1*cos(o1_1)*cos(o1_2)*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2)) + kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)))) - r2_1*(r2_3*(kp2*cos(o2_2)*sin(o2_2)*sin(o2_3) + kr2*cos(o2_1)*cos(o2_2)*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))) + r2_2*(kr2*cos(o2_1)^2*cos(o2_2)^2 + kq2*cos(o2_2)^2*sin(o2_1)^2 + kp2*sin(o2_2)^2)) - r3_1*(r3_3*(kp3*cos(o3_2)*sin(o3_2)*sin(o3_3) + kr3*cos(o3_1)*cos(o3_2)*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))) + r3_2*(kr3*cos(o3_1)^2*cos(o3_2)^2 + kq3*cos(o3_2)^2*sin(o3_1)^2 + kp3*sin(o3_2)^2)) - r1_1*(r1_3*(kp1*cos(o1_2)*sin(o1_2)*sin(o1_3) + kr1*cos(o1_1)*cos(o1_2)*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))) + r1_2*(kr1*cos(o1_1)^2*cos(o1_2)^2 + kq1*cos(o1_2)^2*sin(o1_1)^2 + kp1*sin(o1_2)^2)) + r2_3*(r2_3*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kp2*cos(o2_2)^2*cos(o2_3)*sin(o2_3)) - r2_2*(kp2*cos(o2_2)*cos(o2_3)*sin(o2_2) - kr2*cos(o2_1)*cos(o2_2)*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2)) + kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)))) + r3_3*(r3_3*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)) + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kp3*cos(o3_2)^2*cos(o3_3)*sin(o3_3)) - r3_2*(kp3*cos(o3_2)*cos(o3_3)*sin(o3_2) - kr3*cos(o3_1)*cos(o3_2)*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2)) + kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)))),                                                                                   - r1_1*(r1_2*(kp1*cos(o1_2)*sin(o1_2)*sin(o1_3) + kr1*cos(o1_1)*cos(o1_2)*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))) + r1_3*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))^2 + kr1*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3))^2 + kp1*cos(o1_2)^2*sin(o1_3)^2)) - r2_1*(r2_2*(kp2*cos(o2_2)*sin(o2_2)*sin(o2_3) + kr2*cos(o2_1)*cos(o2_2)*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))) + r2_3*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))^2 + kr2*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3))^2 + kp2*cos(o2_2)^2*sin(o2_3)^2)) - r3_1*(r3_2*(kp3*cos(o3_2)*sin(o3_2)*sin(o3_3) + kr3*cos(o3_1)*cos(o3_2)*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))) + r3_3*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))^2 + kr3*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3))^2 + kp3*cos(o3_2)^2*sin(o3_3)^2)) - r1_2*(r1_3*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kp1*cos(o1_2)^2*cos(o1_3)*sin(o1_3)) - r1_2*(kp1*cos(o1_2)*cos(o1_3)*sin(o1_2) - kr1*cos(o1_1)*cos(o1_2)*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2)) + kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)))) - r2_2*(r2_3*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kp2*cos(o2_2)^2*cos(o2_3)*sin(o2_3)) - r2_2*(kp2*cos(o2_2)*cos(o2_3)*sin(o2_2) - kr2*cos(o2_1)*cos(o2_2)*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2)) + kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)))) - r3_2*(r3_3*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)) + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kp3*cos(o3_2)^2*cos(o3_3)*sin(o3_3)) - r3_2*(kp3*cos(o3_2)*cos(o3_3)*sin(o3_2) - kr3*cos(o3_1)*cos(o3_2)*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2)) + kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))));
                                                                                                                                                                                                                                                                                                                                                 r1_1*(kp1*cos(o1_2)*cos(o1_3)*sin(o1_2) - kr1*cos(o1_1)*cos(o1_2)*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2)) + kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))) + r2_1*(kp2*cos(o2_2)*cos(o2_3)*sin(o2_2) - kr2*cos(o2_1)*cos(o2_2)*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2)) + kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))) + r3_1*(kp3*cos(o3_2)*cos(o3_3)*sin(o3_2) - kr3*cos(o3_1)*cos(o3_2)*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2)) + kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))) + r1_3*(kq1*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))^2 + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))^2 + kp1*cos(o1_2)^2*cos(o1_3)^2) + r2_3*(kq2*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))^2 + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))^2 + kp2*cos(o2_2)^2*cos(o2_3)^2) + r3_3*(kq3*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))^2 + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))^2 + kp3*cos(o3_2)^2*cos(o3_3)^2), r1_1*(kp1*cos(o1_2)*sin(o1_2)*sin(o1_3) + kr1*cos(o1_1)*cos(o1_2)*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))) - r2_3*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kp2*cos(o2_2)^2*cos(o2_3)*sin(o2_3)) - r3_3*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)) + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kp3*cos(o3_2)^2*cos(o3_3)*sin(o3_3)) - r1_3*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kp1*cos(o1_2)^2*cos(o1_3)*sin(o1_3)) + r2_1*(kp2*cos(o2_2)*sin(o2_2)*sin(o2_3) + kr2*cos(o2_1)*cos(o2_2)*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))) + r3_1*(kp3*cos(o3_2)*sin(o3_2)*sin(o3_3) + kr3*cos(o3_1)*cos(o3_2)*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))),                                                                                                                                                                                                                                                                                                                                                                 - r1_3*(kp1*cos(o1_2)*cos(o1_3)*sin(o1_2) - kr1*cos(o1_1)*cos(o1_2)*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2)) + kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))) - r2_3*(kp2*cos(o2_2)*cos(o2_3)*sin(o2_2) - kr2*cos(o2_1)*cos(o2_2)*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2)) + kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))) - r3_3*(kp3*cos(o3_2)*cos(o3_3)*sin(o3_2) - kr3*cos(o3_1)*cos(o3_2)*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2)) + kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))) - r1_1*(kr1*cos(o1_1)^2*cos(o1_2)^2 + kq1*cos(o1_2)^2*sin(o1_1)^2 + kp1*sin(o1_2)^2) - r2_1*(kr2*cos(o2_1)^2*cos(o2_2)^2 + kq2*cos(o2_2)^2*sin(o2_1)^2 + kp2*sin(o2_2)^2) - r3_1*(kr3*cos(o3_1)^2*cos(o3_2)^2 + kq3*cos(o3_2)^2*sin(o3_1)^2 + kp3*sin(o3_2)^2),                                                                                                                                                                                                                                     r1_3*(r1_3*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kp1*cos(o1_2)^2*cos(o1_3)*sin(o1_3)) - r1_1*(kp1*cos(o1_2)*sin(o1_2)*sin(o1_3) + kr1*cos(o1_1)*cos(o1_2)*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3)))) - r2_2*(r2_3*(kp2*cos(o2_2)*cos(o2_3)*sin(o2_2) - kr2*cos(o2_1)*cos(o2_2)*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2)) + kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))) + r2_1*(kr2*cos(o2_1)^2*cos(o2_2)^2 + kq2*cos(o2_2)^2*sin(o2_1)^2 + kp2*sin(o2_2)^2)) - r3_2*(r3_3*(kp3*cos(o3_2)*cos(o3_3)*sin(o3_2) - kr3*cos(o3_1)*cos(o3_2)*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2)) + kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))) + r3_1*(kr3*cos(o3_1)^2*cos(o3_2)^2 + kq3*cos(o3_2)^2*sin(o3_1)^2 + kp3*sin(o3_2)^2)) - r1_2*(r1_3*(kp1*cos(o1_2)*cos(o1_3)*sin(o1_2) - kr1*cos(o1_1)*cos(o1_2)*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2)) + kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))) + r1_1*(kr1*cos(o1_1)^2*cos(o1_2)^2 + kq1*cos(o1_2)^2*sin(o1_1)^2 + kp1*sin(o1_2)^2)) + r2_3*(r2_3*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kp2*cos(o2_2)^2*cos(o2_3)*sin(o2_3)) - r2_1*(kp2*cos(o2_2)*sin(o2_2)*sin(o2_3) + kr2*cos(o2_1)*cos(o2_2)*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3)))) + r3_3*(r3_3*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)) + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kp3*cos(o3_2)^2*cos(o3_3)*sin(o3_3)) - r3_1*(kp3*cos(o3_2)*sin(o3_2)*sin(o3_3) + kr3*cos(o3_1)*cos(o3_2)*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3)))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       r1_3*(r1_1*(kp1*cos(o1_2)*cos(o1_3)*sin(o1_2) - kr1*cos(o1_1)*cos(o1_2)*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2)) + kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))) + r1_3*(kq1*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))^2 + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))^2 + kp1*cos(o1_2)^2*cos(o1_3)^2)) + r2_3*(r2_1*(kp2*cos(o2_2)*cos(o2_3)*sin(o2_2) - kr2*cos(o2_1)*cos(o2_2)*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2)) + kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))) + r2_3*(kq2*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))^2 + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))^2 + kp2*cos(o2_2)^2*cos(o2_3)^2)) + r3_3*(r3_1*(kp3*cos(o3_2)*cos(o3_3)*sin(o3_2) - kr3*cos(o3_1)*cos(o3_2)*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2)) + kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))) + r3_3*(kq3*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))^2 + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))^2 + kp3*cos(o3_2)^2*cos(o3_3)^2)) + r1_1*(r1_3*(kp1*cos(o1_2)*cos(o1_3)*sin(o1_2) - kr1*cos(o1_1)*cos(o1_2)*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2)) + kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))) + r1_1*(kr1*cos(o1_1)^2*cos(o1_2)^2 + kq1*cos(o1_2)^2*sin(o1_1)^2 + kp1*sin(o1_2)^2)) + r2_1*(r2_3*(kp2*cos(o2_2)*cos(o2_3)*sin(o2_2) - kr2*cos(o2_1)*cos(o2_2)*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2)) + kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))) + r2_1*(kr2*cos(o2_1)^2*cos(o2_2)^2 + kq2*cos(o2_2)^2*sin(o2_1)^2 + kp2*sin(o2_2)^2)) + r3_1*(r3_3*(kp3*cos(o3_2)*cos(o3_3)*sin(o3_2) - kr3*cos(o3_1)*cos(o3_2)*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2)) + kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))) + r3_1*(kr3*cos(o3_1)^2*cos(o3_2)^2 + kq3*cos(o3_2)^2*sin(o3_1)^2 + kp3*sin(o3_2)^2)),                                                                                   - r1_2*(r1_1*(kp1*cos(o1_2)*cos(o1_3)*sin(o1_2) - kr1*cos(o1_1)*cos(o1_2)*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2)) + kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))) + r1_3*(kq1*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))^2 + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))^2 + kp1*cos(o1_2)^2*cos(o1_3)^2)) - r2_2*(r2_1*(kp2*cos(o2_2)*cos(o2_3)*sin(o2_2) - kr2*cos(o2_1)*cos(o2_2)*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2)) + kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))) + r2_3*(kq2*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))^2 + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))^2 + kp2*cos(o2_2)^2*cos(o2_3)^2)) - r3_2*(r3_1*(kp3*cos(o3_2)*cos(o3_3)*sin(o3_2) - kr3*cos(o3_1)*cos(o3_2)*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2)) + kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))) + r3_3*(kq3*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))^2 + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))^2 + kp3*cos(o3_2)^2*cos(o3_3)^2)) - r1_1*(r1_3*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kp1*cos(o1_2)^2*cos(o1_3)*sin(o1_3)) - r1_1*(kp1*cos(o1_2)*sin(o1_2)*sin(o1_3) + kr1*cos(o1_1)*cos(o1_2)*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3)))) - r2_1*(r2_3*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kp2*cos(o2_2)^2*cos(o2_3)*sin(o2_3)) - r2_1*(kp2*cos(o2_2)*sin(o2_2)*sin(o2_3) + kr2*cos(o2_1)*cos(o2_2)*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3)))) - r3_1*(r3_3*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)) + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kp3*cos(o3_2)^2*cos(o3_3)*sin(o3_3)) - r3_1*(kp3*cos(o3_2)*sin(o3_2)*sin(o3_3) + kr3*cos(o3_1)*cos(o3_2)*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))));
                                                                                                                             - r1_1*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kp1*cos(o1_2)^2*cos(o1_3)*sin(o1_3)) - r2_1*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kp2*cos(o2_2)^2*cos(o2_3)*sin(o2_3)) - r3_1*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)) + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kp3*cos(o3_2)^2*cos(o3_3)*sin(o3_3)) - r1_2*(kq1*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))^2 + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))^2 + kp1*cos(o1_2)^2*cos(o1_3)^2) - r2_2*(kq2*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))^2 + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))^2 + kp2*cos(o2_2)^2*cos(o2_3)^2) - r3_2*(kq3*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))^2 + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))^2 + kp3*cos(o3_2)^2*cos(o3_3)^2),                                                                                                                               r1_2*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kp1*cos(o1_2)^2*cos(o1_3)*sin(o1_3)) + r2_2*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kp2*cos(o2_2)^2*cos(o2_3)*sin(o2_3)) + r3_2*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)) + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kp3*cos(o3_2)^2*cos(o3_3)*sin(o3_3)) + r1_1*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))^2 + kr1*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3))^2 + kp1*cos(o1_2)^2*sin(o1_3)^2) + r2_1*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))^2 + kr2*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3))^2 + kp2*cos(o2_2)^2*sin(o2_3)^2) + r3_1*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))^2 + kr3*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3))^2 + kp3*cos(o3_2)^2*sin(o3_3)^2), r1_2*(kp1*cos(o1_2)*cos(o1_3)*sin(o1_2) - kr1*cos(o1_1)*cos(o1_2)*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2)) + kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))) + r2_2*(kp2*cos(o2_2)*cos(o2_3)*sin(o2_2) - kr2*cos(o2_1)*cos(o2_2)*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2)) + kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))) + r3_2*(kp3*cos(o3_2)*cos(o3_3)*sin(o3_2) - kr3*cos(o3_1)*cos(o3_2)*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2)) + kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))) - r1_1*(kp1*cos(o1_2)*sin(o1_2)*sin(o1_3) + kr1*cos(o1_1)*cos(o1_2)*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))) - r2_1*(kp2*cos(o2_2)*sin(o2_2)*sin(o2_3) + kr2*cos(o2_1)*cos(o2_2)*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))) - r3_1*(kp3*cos(o3_2)*sin(o3_2)*sin(o3_3) + kr3*cos(o3_1)*cos(o3_2)*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))), r1_2*(r1_2*(kp1*cos(o1_2)*cos(o1_3)*sin(o1_2) - kr1*cos(o1_1)*cos(o1_2)*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2)) + kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))) - r1_1*(kp1*cos(o1_2)*sin(o1_2)*sin(o1_3) + kr1*cos(o1_1)*cos(o1_2)*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3)))) + r2_2*(r2_2*(kp2*cos(o2_2)*cos(o2_3)*sin(o2_2) - kr2*cos(o2_1)*cos(o2_2)*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2)) + kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))) - r2_1*(kp2*cos(o2_2)*sin(o2_2)*sin(o2_3) + kr2*cos(o2_1)*cos(o2_2)*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3)))) + r3_2*(r3_2*(kp3*cos(o3_2)*cos(o3_3)*sin(o3_2) - kr3*cos(o3_1)*cos(o3_2)*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2)) + kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))) - r3_1*(kp3*cos(o3_2)*sin(o3_2)*sin(o3_3) + kr3*cos(o3_1)*cos(o3_2)*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3)))) - r1_3*(r1_2*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kp1*cos(o1_2)^2*cos(o1_3)*sin(o1_3)) + r1_1*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))^2 + kr1*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3))^2 + kp1*cos(o1_2)^2*sin(o1_3)^2)) - r2_3*(r2_2*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kp2*cos(o2_2)^2*cos(o2_3)*sin(o2_3)) + r2_1*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))^2 + kr2*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3))^2 + kp2*cos(o2_2)^2*sin(o2_3)^2)) - r3_3*(r3_2*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)) + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kp3*cos(o3_2)^2*cos(o3_3)*sin(o3_3)) + r3_1*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))^2 + kr3*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3))^2 + kp3*cos(o3_2)^2*sin(o3_3)^2)), - r1_1*(r1_2*(kp1*cos(o1_2)*cos(o1_3)*sin(o1_2) - kr1*cos(o1_1)*cos(o1_2)*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2)) + kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))) - r1_1*(kp1*cos(o1_2)*sin(o1_2)*sin(o1_3) + kr1*cos(o1_1)*cos(o1_2)*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kq1*cos(o1_2)*sin(o1_1)*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3)))) - r2_1*(r2_2*(kp2*cos(o2_2)*cos(o2_3)*sin(o2_2) - kr2*cos(o2_1)*cos(o2_2)*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2)) + kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))) - r2_1*(kp2*cos(o2_2)*sin(o2_2)*sin(o2_3) + kr2*cos(o2_1)*cos(o2_2)*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kq2*cos(o2_2)*sin(o2_1)*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3)))) - r3_1*(r3_2*(kp3*cos(o3_2)*cos(o3_3)*sin(o3_2) - kr3*cos(o3_1)*cos(o3_2)*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2)) + kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))) - r3_1*(kp3*cos(o3_2)*sin(o3_2)*sin(o3_3) + kr3*cos(o3_1)*cos(o3_2)*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kq3*cos(o3_2)*sin(o3_1)*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3)))) - r1_3*(r1_1*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kp1*cos(o1_2)^2*cos(o1_3)*sin(o1_3)) + r1_2*(kq1*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))^2 + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))^2 + kp1*cos(o1_2)^2*cos(o1_3)^2)) - r2_3*(r2_1*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kp2*cos(o2_2)^2*cos(o2_3)*sin(o2_3)) + r2_2*(kq2*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))^2 + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))^2 + kp2*cos(o2_2)^2*cos(o2_3)^2)) - r3_3*(r3_1*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)) + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kp3*cos(o3_2)^2*cos(o3_3)*sin(o3_3)) + r3_2*(kq3*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))^2 + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))^2 + kp3*cos(o3_2)^2*cos(o3_3)^2)), r1_2*(r1_1*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kp1*cos(o1_2)^2*cos(o1_3)*sin(o1_3)) + r1_2*(kq1*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2))^2 + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))^2 + kp1*cos(o1_2)^2*cos(o1_3)^2)) + r2_2*(r2_1*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kp2*cos(o2_2)^2*cos(o2_3)*sin(o2_3)) + r2_2*(kq2*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2))^2 + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))^2 + kp2*cos(o2_2)^2*cos(o2_3)^2)) + r3_2*(r3_1*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)) + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kp3*cos(o3_2)^2*cos(o3_3)*sin(o3_3)) + r3_2*(kq3*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2))^2 + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))^2 + kp3*cos(o3_2)^2*cos(o3_3)^2)) + r1_1*(r1_2*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))*(cos(o1_1)*sin(o1_3) - cos(o1_3)*sin(o1_1)*sin(o1_2)) + kr1*(sin(o1_1)*sin(o1_3) + cos(o1_1)*cos(o1_3)*sin(o1_2))*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3)) - kp1*cos(o1_2)^2*cos(o1_3)*sin(o1_3)) + r1_1*(kq1*(cos(o1_1)*cos(o1_3) + sin(o1_1)*sin(o1_2)*sin(o1_3))^2 + kr1*(cos(o1_3)*sin(o1_1) - cos(o1_1)*sin(o1_2)*sin(o1_3))^2 + kp1*cos(o1_2)^2*sin(o1_3)^2)) + r2_1*(r2_2*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))*(cos(o2_1)*sin(o2_3) - cos(o2_3)*sin(o2_1)*sin(o2_2)) + kr2*(sin(o2_1)*sin(o2_3) + cos(o2_1)*cos(o2_3)*sin(o2_2))*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3)) - kp2*cos(o2_2)^2*cos(o2_3)*sin(o2_3)) + r2_1*(kq2*(cos(o2_1)*cos(o2_3) + sin(o2_1)*sin(o2_2)*sin(o2_3))^2 + kr2*(cos(o2_3)*sin(o2_1) - cos(o2_1)*sin(o2_2)*sin(o2_3))^2 + kp2*cos(o2_2)^2*sin(o2_3)^2)) + r3_1*(r3_2*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))*(cos(o3_1)*sin(o3_3) - cos(o3_3)*sin(o3_1)*sin(o3_2)) + kr3*(sin(o3_1)*sin(o3_3) + cos(o3_1)*cos(o3_3)*sin(o3_2))*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3)) - kp3*cos(o3_2)^2*cos(o3_3)*sin(o3_3)) + r3_1*(kq3*(cos(o3_1)*cos(o3_3) + sin(o3_1)*sin(o3_2)*sin(o3_3))^2 + kr3*(cos(o3_3)*sin(o3_1) - cos(o3_1)*sin(o3_2)*sin(o3_3))^2 + kp3*cos(o3_2)^2*sin(o3_3)^2))];


[q_TRA,R_TRA] = TRA_finder(I,[0;1;0]);
R = [R_TRA zeros(3);zeros(3) R_TRA];
M_TRA = R*M*R.';
K_TRA = R*K*R.';

A = K_TRA*[0;0;0;0;1;0];
B = w2_TRA*M_TRA*[0;0;0;0;1;0];

F = norm(A-B);